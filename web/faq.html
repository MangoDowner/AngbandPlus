<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
  <head>
    <title>(LAngband FAQ)</title>
  </head>
  
  <body bgcolor="white">
    
    <h1 align=center>LAngband FAQ</h1>

    <ol type=i>
      <li> <b>What is Langband?</b><br>
	Langband is a rewrite of the traditional/vanilla version of
	Angband.  It is based on version 2.9.0, but will be upgraded to
	2.9.x at a later stage.  Langband is written in Common Lisp,
	which will allow me to combine the dynamic nature of easy
	scripting with good compiler technology providing an
	environment that allows a very high level of customisation and
	the necessary speed.  It is a toy project which I work on when
	I find time, and the development-pace reflects this.  However,
	even if it is a toy-project, I try to write quality-code and
	have a good design.  This also ensures that it will take more
	time than the usual Angband-variant.</li>

      <li> <b>Where can I download it?</b><br>
	It isn't finished yet and won't be finished for some time as
	it will need go to through several stages, as all newly
	written programs must.  I hope to have a minimal playable
	version ready in the 1st quarter of 2002.  You can check it
	out from CVS or download pre-alpha versions on Sourceforge
	though.  There are also some experimental debian-packages if
	you use debian, and if you have Debian these are the simplest to
	get started with. </li>

      <li> <b>Does it run on [insert OS]?</b><br>
	The main development-platform is my x86 Debian-system,
	using CMU Common Lisp.  The status of various ports is as
	follows (things are still in development so the overall
	"product" is fairly incomplete):

	<table border=1>
	  <tr><th>Implementation</th><th>Architecture</th><th>Status</th></tr>
	  <tr><td>CMUCL 3.x</td><td>Debian x86</td><td>Well-tested</td></tr>
	  <tr><td>ACL 6.0 (Prof)</td><td>Debian x86</td><td>Tested bi-weekly</td></tr>
	  <tr><td>CLISP 2.26</td><td>Debian x86</td><td>Tested monthly.  not optimised</td></tr>
	  <tr><td>LispWorks 4.1.20</td><td>Debian x86</td><td>Recent/immature port.  not optimised</td></tr>
	  <tr><td>LispWorks 4.1.20</td><td>Win98</td><td>Recent/immature port.  not optimised</td></tr>
	  <tr><td>Corman Lisp 1.5b</td><td>Win98</td><td>Incomplete port.  not finished</td></tr>
	</table>

	The status for the various UI-interfaces are as follows:
	<ul>
	  <li> X11 is the most mature and the one used for
	  development.
	  <li> GCU is tested basically only for releases.
	  <li> Gtk+ is non-prioritised at the moment, but is usually
	  tested at releases.
	  <li> Win is a very immature port with many errors.
	</ul>
      </li>

      <li> <b>I found a bug, what do I do?</b><br>
	Please check if the bug has been reported first in the <a
	href="http://sourceforge.net/bugs/?group_id=6938">Sourceforge
	bug-tracking</a>.  If it is not reported, please try to
	describe what caused the crash, include any messages printed
	before the crash, and if you were dumped into the
	lisp-debugger please include a backtrace.  This is
	accomplished in CMUCL with the command 'backtrace' and in ACL
	with the command ':zo'.  These commands work in the
	debugger.</li>
      
      <li> <b>How can I see if a bug is fixed?</b><br>
	A reported bug will be marked as FIXED when it is fixed and
	the updated code has been put in the CVS-tree.  The priority
	of a FIXED bug is set to the minimum.  It will be
	marked as CLOSED when a new release have been made where the
	bug is fixed.  If you reported the bug, you will be mailed
	whenever there is an update on the bug.<br>
	BTW: If you have extra
	information on a non-fixed bug, please add it.</li>

      <li> <b>My save-game from last version does not work in the
	  newest version, why?</b><br>
	As long as the game is not really playable the save/load code
	is not enhanced for backward-compatibility and is all-in-all
	one of the more fragile parts of Langband.  But please report
	bugs and they will be fixed.</li>
      
      <li> <b>The game is sluggish once in awhile, why?</b><br>
	I have noticed this earlier though not frequently anymore.  It
	might be the garbage-collector interfering.  This will be
	adressed gradually and memory-allocation will be reduced when
	it is a problem.  But during early development this isn't
	crucial. <br>
	Note: This is still visible in the slower CLISP and in the
	win32-port if the lispworks-code isn't compiled.  Gradual
	optimisation of the code will probably "remove" this
	"problem".  </li>

      <li> <b>The game holds for a few seconds when I change levels, why?</b><br>
	There are two replies, choose the one that you feel
	comfortable with.  <br>
	<ul>
	  <li> To prevent stair-scumming (a common exploit) a delay
	  has been added to the use of stairs.  This has been designed
	  into the game.</li>
	  <li> To prevent the garbage-collector interfering with the game
	  during normal game-play, full garbage-collects are run
	  before and after level­generation.  This slows down change
	  between levels.  This is very noticable in ACL. </li>
	</ul>
      
      <li> <b>How do I get things working with CLISP?</b><br>
	It's a bit tricky still but can be done.  Assuming csh/tcsh
	you can do:
	
	<pre>
	  $ make
	  $ clisp -q -ansi
	  &gt; (load "game")  ;; this stops at foreign loading, use ^D to quit
	  $ setenv LD_LIBRARY_PATH `pwd`/linking
	  $ make clisp-link
	  $ linked/lisp.run -B /usr/lib/clisp -M linked/lispinit.mem -q -ansi
	  &gt; (load "game") ;; this should work now
	</pre>
	This will be improved later, but it's an important step
	ahead.  You might need to edit the paths in Makefile and
	linking/Makefile.  For other shells use the equivalent command
	of setenv which sets and environment value.</li> 

      <li> <b>How do I get things working with LispWorks Windows?</b><br>
	Currently it's not 100% streamlined, but if you have it
	installed in <tt>c:/cygwin/home/default/langband/</tt> you
	might edit zterm/Makefile and set ENVIRONMENTS to WIN and
	compile zterm with 'make', and then do:

	<pre>
	  &gt; (setq *default-pathname-defaults* #p"c:/cygwin/home/default/langband/")
	  &gt; (load "game")
	  &gt; (lb::a)
	</pre>
      
      <li> <b>How is the code structured?</b><br>
	Currently the code is changed frequently and this answer may
	not be up-to-date.  Please look at the <a
	href="tech.html">Technical description</a> for an hopefully
	updated description.</li> 

      <li> <b>You seem to favour classes with datamembers over
	  bitfields, why?</b><br>
	I tend to favour using clear and readable classes over
	bitfields for one reason: it's easier to understand, use and
	easier to extend.  However, I know that it is sometimes
	beneficial to use bitfields but I'll try to hide that behind
	declarative structures, ie make it an
	implementation-detail.  Resistance and immunity to elements
	are examples of bitfields that are generated from a
	specification.
      </li>

      
      <li> <b>The code in CVS crashes/does not work, why?</b><br>
	The code in CVS is development code, and might not even
	compile, and much less work.  Please use releases if you want
	things to "work".  The CVS-version is bleeding edge though and
	may have bug-fixes and features missing in releases.  CVS is
	also where exciting things happen and where you can track
	day-to-day development.</li>

      <li> <b>Regular Angband has several windows, where are the other
	  windows in Langband?</b><br>
	Several windows can be quite useful but they introduce some
	extra complexity which isn't essential this early in
	development.  So until the game reaches a stage where more
	windows is needed it will remain a single-window game.
      </li>
      
      <li> <b>When I quit the game, my whole lisp is terminated, why?</b><br>
	Some parts of the UI-code is still structured as if it was
	still an app with main() that is started and then quitted when
	one is done playing.  This is extremely annoying if you use a
	slow loader like CMUCL or a big graphical IDE like LispWorks.
	I hope to eventually make things more intelligent, but this
	will take time.  <b>[Note: This should be fixed in current CVS
	for X11 and curses, tested with CMUCL, Lispworks and ACL.]</b></li>
      
      <li> <b>How do I get sounds working?</b><br>
	<ol>
	  <li> uncomment the using-sound line in game.lisp</li>
	  <li> set SOUND_USE in zterm/Makefile to YES</li>
	  <li> recompile all C-code and lisp-code</li>
	  <li> get example sounds from the <a
	  href="http://sourceforge.net/projects/langband/">langband
	  project page</a> dowload area
	  <li> install wanted sounds in lib/sound and configure in
	  lib/file/sound.lisp</li>
	  <li> start zterm/sound_daemon in the background</li>
	  <li> start the game </li>
	  <li> play the game and if possible, hit something</li>
	  <li> quit game and exit the sound_daemon</li>
	</ol>
      </li>

      <li> <b>CMUCL freezes in lib/compat/obj-kind.lisp, or? [obsolete]</b><br>
	It just takes a really really long time to compile in CMUCL,
	several minutes.  This file is for compatibility with
	traditional angband and isn't really needed when the necessary
	files have been converted to lisp.  Please be patient. </li>

      <li> <b>I am a lisper, but I find parts of the code a bit odd,
      why is it the way it is?</b><br>

	<p>
	  The code is in development and changes relatively often and
	  the interface for the engine that should be extensible and
	  alterable by variants and user-code needs to gradually be worked
	  out.  This must be done gradually as I need to experiment with
	  <i>what</i> is interesting to extend/alter, and <i>what</i>
	  can be extended/altered and still get reasonable performance
	  and decent-looking code.
	</p>

	<p>
	  Some of the interface will be functions which variants may
	  call, and sometimes with function-arguments as plug-ins.
	  Other parts will be generic functions which are designed to
	  be tailoured by a variant.  Other parts are extensible
	  classes which variants are allowed to extend.  As this
	  interface gets clearer it will be exported from the
	  <code>:org.langband.engine</code> package and variants will
	  reside in their own packages.  But we're not there yet, so
	  vanilla currently lives in the same package.
	</p>
	
      
    </ol>
	
  </body>
</html>
