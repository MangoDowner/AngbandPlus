#FIND_LIBRARY (BASS_LIBRARY
#    NAMES bass24
#    PATHS ${ROOT}/bass24
#)
FIND_PATH (BASS_INCLUDE_DIR bass.h
    PATHS ${ROOT}/bass24/C
)

IF (CYGWIN OR MINGW)
	SET (BASS_LIBRARY ${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/libbass24.a)
	ADD_CUSTOM_COMMAND (
		OUTPUT ${BASS_LIBRARY}
		COMMAND dlltool
		--kill-at
		--def ${CMAKE_CURRENT_SOURCE_DIR}/bass24.def
		--output-lib ${BASS_LIBRARY}
	)
ENDIF (CYGWIN OR MINGW)

SET_PROPERTY (
    DIRECTORY
    PROPERTY COMPILE_DEFINITIONS
	USE_TCL_STUBS
	${PLATFORM}
)

INCLUDE_DIRECTORIES (
    ${TCL_HRDS}
    ${BASS_INCLUDE_DIR}
)

SET (MUSIC_DLL music-bass)

ADD_LIBRARY (${MUSIC_DLL}
    SHARED
    music.c
    ${BASS_LIBRARY}
)

SET_TARGET_PROPERTIES (${MUSIC_DLL}
    PROPERTIES PREFIX ""
)

TARGET_LINK_LIBRARIES (${MUSIC_DLL}
    ${TCL_STUB_LIBRARY}
    ${BASS_LIBRARY}
    gdi32
)

INSTALL (
	TARGETS ${MUSIC_DLL}
	RUNTIME DESTINATION lib
)
